CREATE TABLE IF NOT EXISTS "Predictions" (
    "PredictionID" INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "PatientID" INT,
    "RawOutput" REAL NOT NULL,
    "PredictedClass" INT NOT NULL,
    "PredictedLabel" VARCHAR(50) NOT NULL,
    "ModelVersion" VARCHAR(50),
    "PredictedAt" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "FeatureSnapshot" JSONB,
    FOREIGN KEY ("PatientID") REFERENCES "Patients" ("PatientID") ON DELETE SET NULL
);

CREATE INDEX IF NOT EXISTS idx_predictions_patientid ON "Predictions"("PatientID");
CREATE INDEX IF NOT EXISTS idx_predictions_predictedat ON "Predictions"("PredictedAt");

